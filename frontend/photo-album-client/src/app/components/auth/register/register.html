<div class="register-container">
  <h2>Create account</h2>

  <form #registerForm="ngForm" (ngSubmit)="onSubmit(registerForm)" novalidate>
    <!-- Name -->
    <div class="form-group">
      <label for="name">Full name</label>
      <input
        id="name"
        type="text"
        [(ngModel)]="name"
        name="name"
        required
        #nameRef="ngModel"
      />
      <div class="error" *ngIf="nameRef.invalid && (nameRef.dirty || nameRef.touched)">
        <small>
          Full name is required
        </small>
      </div>
    </div>

    <!-- Email -->
    <div class="form-group">
      <label for="email">Email</label>
      <input
        id="email"
        type="email"
        [(ngModel)]="email"
        name="email"
        required
        email
        #emailRef="ngModel"
      />
      <div class="error" *ngIf="emailRef.invalid && (emailRef.dirty || emailRef.touched)">
        <small *ngIf="emailRef.errors?.['required']">
          Email is required
        </small>
        <small *ngIf="emailRef.errors?.['email']">
          Please enter a valid email
        </small>
      </div>
    </div>

    <!-- Password -->
    <div class="form-group">
      <label for="password">Password</label>
      <input
        id="password"
        type="password"
        [(ngModel)]="password"
        name="password"
        required
        minlength="6"
        #passwordRef="ngModel"
      />
      <div class="error" *ngIf="passwordRef.invalid && (passwordRef.dirty || passwordRef.touched)">
        <small *ngIf="passwordRef.errors?.['required']">
          Password is required
        </small>
        <small *ngIf="passwordRef.errors?.['minlength']">
          Password must be at least 6 characters
        </small>
      </div>
    </div>

    <!-- Confirm password -->
    <div class="form-group">
      <label for="confirmPassword">Confirm password</label>
      <input
        id="confirmPassword"
        type="password"
        [(ngModel)]="confirmPassword"
        name="confirmPassword"
        required
        #confirmPasswordRef="ngModel"
      />
      <div
        class="error"
        *ngIf="(confirmPasswordRef.dirty || confirmPasswordRef.touched) &&
               (confirmPasswordRef.invalid || password !== confirmPassword)"
      >
        <small *ngIf="confirmPasswordRef.errors?.['required']">
          Please confirm your password
        </small>
        <small *ngIf="!confirmPasswordRef.errors && password && confirmPassword && password !== confirmPassword">
          Passwords do not match
        </small>
      </div>
    </div>

    <!-- API error -->
    <div *ngIf="errorMessage" class="error">
      {{ errorMessage }}
    </div>

    <!-- Success message (e.g., fallback path) -->
    <div *ngIf="successMessage" class="success">
      {{ successMessage }}
    </div>

    <button
      type="submit"
      [disabled]="isLoading || registerForm.invalid || password !== confirmPassword"
    >
      {{ isLoading ? 'Creating account...' : 'Create account' }}
    </button>
  </form>

  <p class="helper-link">
    Already have an account?
    <a routerLink="/login">Sign in</a>
  </p>
</div>
